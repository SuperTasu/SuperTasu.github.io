<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>サイト集</title>
  <link rel="icon" href="your-favicon.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --bg-color: #ffffff;
      --text-color-primary: #333;
      --text-color-secondary: #666;
      --card-bg: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      --card-border-color: rgba(0,0,0,0.1);
      --card-shadow: 0 4px 16px rgba(0,0,0,0.1);
      --icon-bg: #fff;
      --icon-shadow: 0 4px 12px rgba(0,0,0,0.15);
      --tab-active-text: #ffffff;
      --input-bg: #e9ecef;
    }

    body.dark-theme {
      --bg-color: #434343;
      --text-color-primary: #f5f5f5;
      --text-color-secondary: #aaa;
      --card-bg: linear-gradient(135deg, #2c2c2c 0%, #3a3a3a 100%);
      --card-border-color: rgba(255,255,255,0.1);
      --card-shadow: 0 4px 16px rgba(0,0,0,0.4);
      --icon-bg: #555;
      --icon-shadow: 0 4px 12px rgba(0,0,0,0.5);
      --tab-active-text: #ffffff;
      --input-bg: #3a3a3a;
    }
    
    body {
      margin: 0;
      background-color: var(--bg-color);
      color: var(--text-color-primary);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 0;
      transition: background-color 0.3s, color 0.3s;
    }

    .clock-area {
      background: var(--card-bg);
      box-shadow: var(--card-shadow);
      margin: 20px auto;
      border-radius: 20px;
      padding: 15px 25px;
      max-width: 1200px;
      border: 1px solid var(--card-border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }

    .clock-content-wrapper { display: flex; flex-direction: column; align-items: flex-start; gap: 15px; flex-grow: 1; }
    .clock-container { display: flex; flex-direction: column; align-items: center; gap: 20px; }
    .datetime-row { display: flex; align-items: center; justify-content: center; gap: 30px; flex-wrap: wrap; }
    #date, #clock { color: var(--text-color-primary); font-weight: bold; letter-spacing: 1px; }
    #date { font-size: 18px; }
    #clock { font-size: 24px; font-family: 'Courier New', Courier, monospace; }
    #countdown { color: #667eea; font-weight: bold; font-size: 18px; }
    .header-controls { display: flex; align-items: center; gap: 10px; position: relative; }
    .theme-switcher { position: absolute; top: -20px; right: 35px; display: flex; gap: 5px; }
    .theme-dot { width: 15px; height: 15px; border-radius: 50%; cursor: pointer; border: 2px solid var(--text-color-secondary); transition: transform 0.2s; }
    .theme-dot:hover { transform: scale(1.2); }
    .theme-dot.light { background-color: #f8f9fa; }
    .theme-dot.dark { background-color: #434343; }
    .control-icon { display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: rgba(0,0,0,0.05); border-radius: 50%; color: var(--text-color-secondary); font-size: 18px; text-decoration: none; transition: all 0.2s; }
    .control-icon:hover { background: #667eea; color: white; transform: scale(1.1); }
    
    /* ★★ 変更: 時間計算ツールのスタイルをコンパクト化 ★★ */
    .time-calculator-container {
      display: flex; align-items: center; gap: 8px; justify-content: center;
      background: var(--icon-bg); color: var(--text-color-primary);
      padding: 6px 10px; border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      flex-wrap: wrap; width: fit-content; margin: 0 auto;
    }
    .time-calculator-container label { font-size: 14px; display: inline-flex; align-items: center; gap: 4px; }
    .time-calculator-container input[type="number"] {
      width: 40px; padding: 4px; font-size: 14px;
      border-radius: 6px;
      border: 1px solid var(--card-border-color);
      background-color: var(--bg-color);
      color: var(--text-color-primary);
      text-align: center;
    }
    #resultTime {
      font-family: 'Courier New', Courier, monospace; font-weight: bold; font-size: 15px;
      background: rgba(0,0,0,0.05);
      padding: 4px 8px; border-radius: 6px;
      min-width: 110px; text-align: center;
    }
    body.dark-theme #resultTime { background: rgba(255,255,255,0.1); }
    #resetCalcBtn {
      background: none; border: none; font-size: 16px;
      color: var(--text-color-secondary); cursor: pointer; padding: 5px; line-height: 1;
    }
    #resetCalcBtn:hover { color: #667eea; }

    .tab-container { background: var(--card-bg); box-shadow: var(--card-shadow); margin: 20px auto 30px; border-radius: 20px; overflow: hidden; max-width: 1200px; border: 1px solid var(--card-border-color); }
    .tab-menu { display: flex; align-items: center; }
    .search-container { display: flex; align-items: center; padding: 0 15px; margin: 6px; background-color: var(--input-bg); border-radius: 16px; border: 1px solid rgba(0,0,0,0.1); }
    .search-container i { color: var(--text-color-secondary); }
    #appSearchInput { border: none; background: transparent; outline: none; padding: 10px 8px; font-size: 14px; width: 150px; color: var(--text-color-primary); transition: width 0.3s ease-in-out; }
    #appSearchInput:focus { width: 200px; }
    .tab-item { flex: 1; text-align: center; padding: 15px 20px; color: var(--text-color-secondary); text-decoration: none; font-weight: bold; font-size: 14px; position: relative; transition: all 0.3s ease; border-radius: 16px; margin: 6px; border-right: 1px solid rgba(0,0,0,0.1); cursor: pointer; white-space: nowrap; min-width: 120px; }
    .tab-item:last-child { border-right: none; }
    .tab-item:hover { background-color: rgba(102, 126, 234, 0.1); color: #667eea; transform: translateY(-2px); }
    .tab-item.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: var(--tab-active-text); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transform: translateY(-2px); }
    .tab-menu #tab-all { margin-right: 1px; }
    .tab-menu #tab-google { margin-left: 1px; margin-right: 1px; }
    .tab-menu #tab-sns { margin-left: 1px; }
    .submenu { display: none; background: linear-gradient(135deg, #f0f2f5 0%, #e6eaef 100%); padding: 15px; border-radius: 15px; margin: 0 auto 15px; max-width: 1200px; box-shadow: var(--card-shadow); animation: slideDown 0.3s ease-out; position: relative; z-index: 10; }
    body.dark-theme .submenu { background: linear-gradient(135deg, #2c2c2c 0%, #3a3a3a 100%); }
    .submenu.show { display: block; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .grid-container { display: flex; flex-wrap: wrap; gap: 12px; justify-content: flex-start; max-width: 100%; padding: 10px; }
    .search-item.hidden { display: none; }
    
    #search-wrapper {
      max-width: 1200px; margin: 0 auto; user-select: none;
      position: relative; z-index: 1; border-radius: 15px;
      overflow: hidden; padding-top: 1px;
    }
    #search-wrapper::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image: url('IMAGE_0120.PNG'); background-size: cover;
      background-position: center center; background-attachment: fixed;
      opacity: 0.5; z-index: -1; transition: opacity 0.3s ease-in-out;
    }
    body.dark-theme #search-wrapper::before { opacity: 0.2; }

    #search-wrapper.search-active { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; padding: 20px; }
    .search-active .main-content, .search-active .submenu { display: contents; }
    .search-active .tab-item.active { background: none; color: var(--text-color-secondary); box-shadow: none; transform: none; }
    .icon-item { text-align: center; width: 70px; margin: 0; }
    .icon-link { width: 55px; height: 55px; background-color: var(--icon-bg); border-radius: 20px; box-shadow: var(--icon-shadow); display: flex; align-items: center; justify-content: center; text-decoration: none; color: var(--text-color-primary); margin: 0 auto; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .icon-link:hover { transform: scale(1.1) translateY(-3px); background-color: #e6f2ff; box-shadow: 0 8px 25px rgba(0,0,0,0.2); }
    body.dark-theme .icon-link:hover { background-color: #4a5568; }
    .icon-link i { font-size: 24px; }
    .icon-img { width: 28px; height: 28px; border-radius: 8px; object-fit: contain; }
    .label-text { font-size: 11px; margin-top: 4px; color: var(--text-color-primary); word-break: break-word; line-height: 1.1; }
    .answer-i-icon { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white !important; font-weight: bold; font-size: 20px; }
    .bustarain-icon { background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%); color: white !important; }

    /* 以下、バス時刻表などのスタイルは省略（変更なし） */
    .game-buttons{display:flex;flex-direction:row;gap:20px;align-items:center;justify-content:center;flex-wrap:wrap}.game-button{display:flex;align-items:center;gap:8px;padding:12px 20px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-decoration:none;border-radius:25px;font-weight:bold;font-size:14px;transition:all .3s ease;box-shadow:0 4px 12px rgba(102,126,234,.3);width:180px;justify-content:center}.game-button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,.4);background:linear-gradient(135deg,#764ba2 0%,#667eea 100%)}.game-button.apex{background:linear-gradient(135deg,#ff6b35 0%,#f7931e 100%);box-shadow:0 4px 12px rgba(255,107,53,.3)}.game-button.apex:hover{box-shadow:0 6px 20px rgba(255,107,53,.4);background:linear-gradient(135deg,#f7931e 0%,#ff6b35 100%)}.game-button.splatoon{background:linear-gradient(135deg,#00d4ff 0%,#ff6b8a 100%);box-shadow:0 4px 12px rgba(0,212,255,.3)}.status-submenu{display:flex;gap:30px;justify-content:center;align-items:stretch;flex-wrap:wrap}.status-item{display:flex;flex-direction:column;align-items:center;gap:15px;flex-grow:1;flex-basis:320px}.status-item-large{flex-grow:3;flex-basis:1020px;min-width:320px}.status-item-title{font-weight:bold;color:var(--text-color-primary);font-size:16px}.status-speedtest-container,.status-weather-container{width:100%;max-width:350px;height:200px;border-radius:10px;overflow:hidden;position:relative}.status-speedtest-container{background-color:#000}.status-weather-container{background-color:#fff}.status-speedtest-container iframe,.status-weather-container iframe{width:100%;height:100%;border:none}.main-content{padding:20px}.bus-display-wrapper{width:100%;margin:0;font-family:'MS Gothic',monospace}.display-board{background-color:#e8f5e8;border:3px solid #009900;border-radius:10px;padding:12px}.main-header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:12px;flex-wrap:wrap}.bus-stop-name{font-size:18px;font-weight:bold;color:#009900;flex-shrink:0}.direction-controls{display:flex;gap:8px;flex-wrap:wrap}.schedule-type{font-size:13px;color:#009900;font-weight:bold;background-color:#fff;padding:3px 6px;border-radius:5px;border:2px solid #009900;flex-shrink:0}.time-control-section{background-color:#d8e8d8;padding:8px;border-radius:6px;margin-bottom:10px;display:flex;justify-content:center;align-items:center;gap:10px;flex-wrap:wrap}.time-control-section label{font-size:13px;font-weight:bold;color:#333}.time-control-section input[type=datetime-local]{font-family:sans-serif;padding:4px;border:1px solid #009900;border-radius:4px}.time-control-section button{background-color:#0066cc;color:white;border:none;border-radius:4px;padding:5px 10px;font-size:12px;cursor:pointer}#justDepartedSection{margin-bottom:8px}.just-departed-info{font-size:12px;color:#444;background-color:#e0e0e0;padding:3px 8px;margin:0 auto 4px;border:1px solid #ccc;border-radius:5px;max-width:95%;display:flex;justify-content:center;align-items:center;gap:8px;text-align:center}.just-departed-info .route-number{font-size:11px;padding:1px 4px;border-width:1px;margin-right:4px;color:#333;border-color:#333}.departures-row{display:flex;gap:10px}.departure-item{flex:1;min-width:0}.next-departure-content{display:flex;justify-content:space-between;align-items:center;background-color:#fff;border-radius:8px;padding:8px 10px;border:2px solid #009900;min-height:65px}.departure-details-left{display:flex;flex-direction:column;gap:2px}.departure-type-label{font-size:14px;font-weight:bold;color:#333}.next-departure-route{font-size:13px}.next-departure-time{display:flex;flex-direction:column;align-items:flex-end;gap:4px}.next-departure-clock{font-size:22px;font-weight:bold;color:#c00}.time-and-button-row{display:flex;align-items:center;gap:8px}.next-departure-remaining{font-size:16px;font-weight:bold;color:#009900;min-width:105px;text-align:right}.detail-button{display:inline-flex;justify-content:center;align-items:center;width:24px;height:24px;background-color:#0066cc;color:white;border:none;border-radius:50%;font-size:14px;font-weight:bold;text-decoration:none;cursor:pointer;transition:background-color .2s;flex-shrink:0}.detail-button:hover{background-color:#0052a3}.route-number{display:inline-block;border:2px solid #0066cc;padding:1px 5px;margin-right:6px;background-color:#fff;color:#0066cc;font-size:13px;min-width:22px;text-align:center}.itayado-arrival{color:#c60;font-size:11px;font-weight:bold}.no-next-departure{color:#c00;font-size:14px;text-align:center;padding:10px;width:100%;display:flex;align-items:center;justify-content:center}.direction-button{background-color:#f0f0f0;border:2px solid #333;padding:6px 12px;margin:0;font-size:13px;font-weight:bold;cursor:pointer;border-radius:5px;transition:all .3s ease}.direction-button.active{background-color:#0066cc;color:white;border-color:#0066cc}.direction-button:hover:not(.active){background-color:#e0e0e0}.blink{animation:blink 1s infinite}@keyframes blink{0%,49%{opacity:1}50%,100%{opacity:.3}}@media (max-width:1200px){.departures-row{flex-direction:column}}@media (max-width:900px){.clock-area,.tab-container,.submenu{max-width:95%;margin-left:auto;margin-right:auto}.datetime-row{flex-direction:column;gap:10px}.tab-menu{flex-wrap:wrap}.search-container{width:calc(100% - 12px);order:-1}#appSearchInput{width:100%}.tab-item{padding:12px 16px;font-size:13px;min-width:100px}.icon-item{width:80px}.icon-link{width:60px;height:60px}.status-submenu{flex-direction:column;gap:20px;align-items:center}.status-speedtest-container,.status-weather-container{width:300px;height:180px}.next-departure-time{flex-direction:row;align-items:center;gap:8px;margin-top:5px}.next-departure-remaining{font-size:18px;min-width:auto;text-align:left}}
  </style>
</head>
<body>

  <div class="clock-area">
    <div class="clock-content-wrapper">
      <div class="datetime-row"> <div id="date"></div> <div id="clock"></div> <div id="countdown"></div> </div>
      <!-- ★★ 変更: 時間計算ツールのHTML構造 ★★ -->
      <div class="time-calculator-container">
        <i class="fas fa-calculator"></i>
        <label>+ <input id="addHours" type="number" min="0" value="0"> H</label>
        <label><input id="addMinutes" type="number" min="0" value="0"> M</label>
        <label><input id="addSeconds" type="number" min="0" value="0"> S</label>
        <span id="resultTime"></span>
        <button id="resetCalcBtn" title="リセット"><i class="fas fa-history"></i></button>
      </div>
    </div>
    <div class="header-controls">
      <div class="theme-switcher"> <div class="theme-dot light" onclick="setTheme('light')"></div> <div class="theme-dot dark" onclick="setTheme('dark')"></div> </div>
      <a href="https://sites.google.com/view/foretsy/管理者ページ" class="control-icon" target="_blank" title="ADMIN"> <i class="fas fa-cog"></i> </a>
      <a href="https://sites.google.com/view/foretsy/裂け目" class="control-icon" target="_blank" title="Portal"> <i class="fas fa-route"></i> </a>
    </div>
  </div>
  
  <div class="tab-container">
    <div class="tab-menu">
      <div class="search-container"> <i class="fas fa-search"></i> <input type="text" id="appSearchInput" placeholder="検索..."> </div>
      <div class="tab-item" id="tab-all" onclick="activateTab('all')"> <i class="fas fa-th-large"></i> All Apps </div>
      <div class="tab-item" id="tab-google" onclick="activateTab('google')"> <i class="fab fa-google"></i> Google </div>
      <div class="tab-item" id="tab-sns" onclick="activateTab('sns')"> <i class="fas fa-users"></i> SNS </div>
      <div class="tab-item" id="tab-status" onclick="activateTab('status')"> <i class="fas fa-chart-line"></i> Status </div>
    </div>
  </div>

  <div id="search-wrapper">
    <div class="submenu" id="gameSubmenu">
      <div class="game-buttons"> <a href="https://apexlegendsstatus.com/current-map" class="game-button apex search-item" data-search-text="Apex Legends"> <i class="fas fa-crosshairs"></i> Apex Legends </a> <a href="https://www.splatoon3-schedule.net" class="game-button splatoon search-item" data-search-text="Splatoon 3 スプラトゥーン"> <i class="fas fa-paint-brush"></i> Splatoon 3 </a> </div>
    </div>
    <div class="submenu" id="statusSubmenu">
      <div class="status-submenu">
        <div class="status-item status-item-large search-item" data-search-text="バス運行情報 時刻表 鷹取団地"> <div class="status-item-title">バス運行情報</div> <div class="bus-display-wrapper"> <div class="display-board"> <div class="main-header"><div class="bus-stop-name">鷹取団地前→</div><div class="direction-controls"><button id="shinkaichi-btn" class="direction-button">神戸駅前・兵庫駅・大学病院方面</button><button id="yoshidacho-btn" class="direction-button active">板宿・新長田駅前・鷹取駅前方面</button></div><div class="schedule-type" id="scheduleType"></div></div><div class="time-control-section"><label for="busTimeInput">時刻指定:</label><input type="datetime-local" id="busTimeInput"><button id="busTimeResetBtn">現在時刻に戻す</button></div><div id="justDepartedSection"></div><div class="departures-row" id="upcomingDeparturesContainer"></div> </div> </div> </div>
        <div class="status-item search-item" data-search-text="回線速度テスト スピードテスト fast.com"><div class="status-item-title">回線速度テスト</div><div class="status-speedtest-container"> <iframe src="https://fast.com/ja/" title="速度テスト"></iframe> </div></div>
        <div class="status-item search-item" data-search-text="兵庫県警報・注意報 天気 ウェザーニュース"><div class="status-item-title">兵庫県警報・注意報</div><div class="status-weather-container"> <iframe src="https://weathernews.jp/onebox/warn/hyogo/2810000/" title="ウェザーニュース警報・注意報"></iframe> </div></div>
      </div>
    </div>
    <div class="main-content" id="mainContent">
      <div class="grid-container" id="gridContainer">
          <div class="icon-item search-item" data-category="google" data-search-text="Google グーグル"><a href="https://www.google.com" class="icon-link"> <img src="https://www.google.com/favicon.ico" class="icon-img" alt="Google"> </a><div class="label-text">Google</div></div>
          <div class="icon-item search-item" data-category="google" data-search-text="Gmail Google Mail メール"><a href="https://mail.google.com" target="_blank" class="icon-link"> <img src="https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico" class="icon-img" alt="Gmail"> </a><div class="label-text">Gmail</div></div>
          <div class="icon-item search-item" data-category="google" data-search-text="Google Calendar カレンダー"><a href="https://calendar.google.com" target="_blank" class="icon-link"> <img src="https://ssl.gstatic.com/calendar/images/dynamiclogo_2020q4/calendar_3_2x.png" class="icon-img" alt="Calendar"> </a><div class="label-text">Calendar</div></div>
          <div class="icon-item search-item" data-category="google" data-search-text="Google Photos フォト 写真"><a href="https://photos.google.com" target="_blank" class="icon-link"> <img src="https://ssl.gstatic.com/images/branding/product/1x/photos_48dp.png" class="icon-img" alt="Photos"> </a><div class="label-text">Photos</div></div>
          <div class="icon-item search-item" data-category="google" data-search-text="Google Drive ドライブ"><a href="https://drive.google.com" target="_blank" class="icon-link"> <img src="https://ssl.gstatic.com/images/branding/product/2x/drive_2020q4_48dp.png" class="icon-img" alt="Drive"> </a><div class="label-text">Drive</div></div>
          <div class="icon-item search-item" data-category="other" data-search-text="Yahoo! ヤフー"> <a href="https://www.yahoo.co.jp" class="icon-link" target="_blank"> <img src="https://www.yahoo.co.jp/favicon.ico" class="icon-img" alt="Yahoo!"> </a> <div class="label-text">Yahoo!</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="X Twitter ツイッター"> <a href="https://x.com/i/timeline" class="icon-link" target="_blank"> <img src="https://twitter.com/favicon.ico" class="icon-img" alt="X"> </a> <div class="label-text">X</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="Instagram インスタグラム"> <a href="https://www.instagram.com" class="icon-link" target="_blank"> <img src="https://static.cdninstagram.com/rsrc.php/v3/yI/r/VsNE-OHk_8a.png" class="icon-img" alt="Instagram"> </a> <div class="label-text">Instagram</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="YouTube ユーチューブ"> <a href="https://www.youtube.com/feed/subscriptions" class="icon-link" target="_blank"> <img src="https://www.youtube.com/favicon.ico" class="icon-img" alt="YouTube"> </a> <div class="label-text">YouTube</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="YT Shorts YouTube ショート"> <a href="https://www.youtube.com/feed/subscriptions/shorts" class="icon-link" target="_blank"> <i class="fab fa-youtube" style="color: #ff0000;"></i> </a> <div class="label-text">YT Shorts</div> </div>
          <!-- ★★ 変更: イラストアイコン化 ★★ -->
          <div class="icon-item search-item" data-category="other" data-search-text="Remote It リモート"> <a href="https://app.remote.it" class="icon-link" target="_blank"> <i class="fas fa-desktop" style="color: #4285f4;"></i> </a> <div class="label-text">Remote It</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="TikTok ティックトック"> <a href="https://www.tiktok.com" class="icon-link" target="_blank"> <img src="https://www.tiktok.com/favicon.ico" class="icon-img" alt="TikTok"> </a> <div class="label-text">TikTok</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="Twitch ツイッチ"> <a href="https://www.twitch.tv" class="icon-link" target="_blank"> <img src="https://www.twitch.tv/favicon.ico" class="icon-img" alt="Twitch"> </a> <div class="label-text">Twitch</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Abema アベマ"> <a href="https://abema.tv/" class="icon-link" target="_blank"> <img src="https://abema.tv/favicon.ico" class="icon-img" alt="Abema"> </a> <div class="label-text">Abema</div> </div>
          <div class="icon-item search-item" data-category="sns" data-search-text="Discord ディスコード"> <a href="https://discord.com/channels/@me" class="icon-link" target="_blank"> <img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/636e0a69f118df70ad7828d4_icon_clyde_blurple_RGB.svg" class="icon-img" alt="Discord"> </a> <div class="label-text">Discord</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Spotify スポティファイ"> <a href="https://open.spotify.com/intl-ja" class="icon-link" target="_blank"> <img src="https://open.spotify.com/favicon.ico" class="icon-img" alt="Spotify"> </a> <div class="label-text">Spotify</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="神戸市交通局 地下鉄 バス"> <a href="https://kotsu.city.kobe.lg.jp/" class="icon-link" target="_blank"> <i class="fas fa-subway" style="color: #0066cc;"></i> </a> <div class="label-text">神戸市交通局</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="GigaFile ギガファイル便"> <a href="https://gigafile.nu/" class="icon-link" target="_blank"> <img src="https://gigafile.nu/favicon.ico" class="icon-img" alt="GigaFile便"> </a> <div class="label-text">GigaFile</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="ChatGPT AI"> <a href="https://chatgpt.com" class="icon-link" target="_blank"> <img src="https://chat.openai.com/favicon.ico" class="icon-img" alt="ChatGPT"> </a> <div class="label-text">ChatGPT</div> </div>
          <div class="icon-item search-item" data-category="google" data-search-text="Google AI Gemini"> <a href="https://aistudio.google.com/prompts/new_chat" class="icon-link" target="_blank"> <i class="fas fa-brain" style="color: #4285f4;"></i> </a> <div class="label-text">Google AI</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Claude AI クロード"> <a href="https://claude.ai" class="icon-link" target="_blank"> <img src="https://claude.ai/favicon.ico" class="icon-img" alt="Claude AI"> </a> <div class="label-text">Claude AI</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="BUSTARAIN バスタレイン"> <a href="https://sites.google.com/view/bustar/home" class="icon-link bustarain-icon" target="_blank"> <i class="fas fa-bus"></i> </a> <div class="label-text">BUSTARAIN</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Answer I アンサー"> <a href="https://sites.google.com/view/answer-i/home" class="icon-link answer-i-icon" target="_blank"> <i class="fas fa-question-circle"></i> </a> <div class="label-text">Answer I</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Rawkuro ブルーロック 漫画"> <a href="https://rawkuro.net/manga/bururokku004/di285hua" class="icon-link" target="_blank"> <i class="fas fa-futbol" style="color: #1e90ff;"></i> </a> <div class="label-text">Rawkuro</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="MN4U ブルーロック 漫画"> <a href="https://mn4u.net/tgm-84/" class="icon-link" target="_blank"> <img src="https://mn4u.net/favicon.ico" class="icon-img" alt="MN4U"> </a> <div class="label-text">MN4U</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="講談社 ブルーロック 漫画"> <a href="https://kmanga.kodansha.com/title/10008/episode/360423" class="icon-link" target="_blank"> <img src="https://kmanga.kodansha.com/favicon.ico" class="icon-img" alt="講談社"> </a> <div class="label-text">講談社</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="メルカリ フリマ"> <a href="https://www.mercari.com/jp/" class="icon-link" target="_blank"> <img src="https://mercari.com/favicon.ico" class="icon-img" alt="メルカリ"> </a> <div class="label-text">メルカリ</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="Yahoo!フリマ ヤフー"> <a href="https://paypayfleamarket.yahoo.co.jp/" class="icon-link" target="_blank"> <img src="https://paypayfleamarket.yahoo.co.jp/favicon.ico" class="icon-img" alt="Yahoo!フリマ"> </a> <div class="label-text">Yahoo!フリマ</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="ヤマト運輸 宅急便"> <a href="https://www.kuronekoyamato.co.jp/" class="icon-link" target="_blank"> <i class="fas fa-truck" style="color: #00a54f;"></i> </a> <div class="label-text">ヤマト運輸</div> </div>
          <div class="icon-item search-item" data-category="google" data-search-text="Google Sites サイト作成"> <a href="https://sites.google.com/new" class="icon-link" target="_blank"> <i class="fas fa-palette" style="color: #4285f4;"></i> </a> <div class="label-text">Google Sites</div> </div>
          <div class="icon-item search-item" data-category="other" data-search-text="GitHub ギットハブ"> <a href="https://github.com" class="icon-link" target="_blank"> <i class="fab fa-github" style="color: #181717;"></i> </a> <div class="label-text">GitHub</div> </div>
      </div>
    </div>
  </div>

  <script>
    const schedule=[{name:"1限",start:"08:50",end:"09:40"},{name:"休憩",start:"09:40",end:"09:50"},{name:"2限",start:"09:50",end:"10:40"},{name:"休憩",start:"10:40",end:"10:50"},{name:"3限",start:"10:50",end:"11:40"},{name:"休憩",start:"11:40",end:"11:50"},{name:"4限",start:"11:50",end:"12:40"},{name:"昼休み",start:"12:40",end:"13:20"},{name:"5限",start:"13:20",end:"14:10"},{name:"休憩",start:"14:10",end:"14:20"},{name:"6限",start:"14:20",end:"15:10"},{name:"休憩",start:"15:10",end:"15:20"},{name:"7限",start:"15:20",end:"16:10"},{name:"休憩",start:"16:10",end:"16:40"},{name:"8限",start:"16:40",end:"17:30"},{name:"休憩",start:"17:30",end:"17:40"},{name:"9限",start:"17:40",end:"18:30"}];
    const mainContent=document.getElementById("mainContent"),gameSubmenu=document.getElementById("gameSubmenu"),statusSubmenu=document.getElementById("statusSubmenu");
    function parseTimeToDate(t){const[e,n]=t.split(":").map(Number),o=new Date;return o.setHours(e,n,0,0),o}
    function getCurrentPeriod(t){for(const e of schedule){const n=parseTimeToDate(e.start),o=parseTimeToDate(e.end);if(t>=n&&t<o)return{...e,startTime:n,endTime:o}}return null}
    function updateCountdown(t){const e=getCurrentPeriod(t),n=document.getElementById("countdown");if(e){const o=e.endTime-t,a=e.endTime-e.startTime,s=a-o,r=Math.floor(s/a*100),i=Math.floor(o/1e3),l=String(Math.floor(i/3600)).padStart(2,"0"),c=String(Math.floor(i%3600/60)).padStart(2,"0"),d=String(i%60).padStart(2,"0");n.textContent=`${e.name} 残り: ${l}:${c}:${d} (${r}%)`,document.title=`${e.name} Left: ${l}:${c}:${d}`}else n.textContent="現在は授業時間外です",document.title="授業時間外"}
    function updateClockAndDate(){const t=new Date,e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");document.getElementById("clock").textContent=`${e}:${n}:${o}`;const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=["日","月","火","水","木","金","土"][t.getDay()];document.getElementById("date").textContent=`${a}/${s}/${r}(${i})`,updateCountdown(t)}
    function setTheme(t){"dark"===t?(document.body.classList.add("dark-theme"),localStorage.setItem("siteTheme","dark")):(document.body.classList.remove("dark-theme"),localStorage.setItem("siteTheme","light"))}
    function activateTab(t){document.querySelectorAll(".tab-item").forEach(t=>t.classList.remove("active"));const e=document.getElementById(`tab-${t}`);e&&e.classList.add("active"),mainContent.style.display="none",gameSubmenu.classList.remove("show"),statusSubmenu.classList.remove("show"),"status"===t?(gameSubmenu.classList.add("show"),statusSubmenu.classList.add("show")):(mainContent.style.display="block",filterIconsByCategory(t)),localStorage.setItem("siteActiveTab",t)}
    function filterIconsByCategory(t){document.querySelectorAll(".icon-item").forEach(e=>{"all"===t||e.dataset.category===t?e.style.display="block":e.style.display="none"})}
    function filterContent(){const t=document.getElementById("appSearchInput").value.toLowerCase(),e=document.getElementById("search-wrapper"),n=e.querySelectorAll(".search-item");if(t)e.classList.add("search-active"),mainContent.style.display="",gameSubmenu.classList.add("show"),statusSubmenu.classList.add("show"),document.querySelectorAll(".icon-item").forEach(t=>t.style.display="block");else{e.classList.remove("search-active"),n.forEach(t=>t.classList.remove("hidden"));const t=localStorage.getItem("siteActiveTab")||"all";return void activateTab(t)}n.forEach(e=>{e.dataset.searchText.toLowerCase().includes(t)?e.classList.remove("hidden"):e.classList.add("hidden")})}
    const TABS_ORDER=["all","google","sns","status"],swipeArea=document.getElementById("search-wrapper");let touchStartX=0,touchStartY=0,touchEndX=0,touchEndY=0;
    function handleTouchStart(t){touchStartX=t.changedTouches[0].screenX,touchStartY=t.changedTouches[0].screenY}
    function handleTouchEnd(t){touchEndX=t.changedTouches[0].screenX,touchEndY=t.changedTouches[0].screenY,handleSwipeGesture()}
    function handleSwipeGesture(){const t=touchEndX-touchStartX,e=touchEndY-touchStartY;if(Math.abs(t)>Math.abs(e)&&Math.abs(t)>50){const e=localStorage.getItem("siteActiveTab")||"all";let n=TABS_ORDER.indexOf(e);t<0?n=(n+1)%TABS_ORDER.length:n=(n-1+TABS_ORDER.length)%TABS_ORDER.length,activateTab(TABS_ORDER[n])}}
    const timetables={shinkaichi:{route11:{name:"神戸駅前方面",number:"11",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0016",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[12,27,42]},{hour:7,minutes:[7,24,38,52,59]},{hour:8,minutes:[11,21,32,44,51]},{hour:9,minutes:[5,13,37,49]},{hour:10,minutes:[25,50]},{hour:11,minutes:[1,25]},{hour:12,minutes:[2,25]},{hour:13,minutes:[2,25]},{hour:14,minutes:[2,25]},{hour:15,minutes:[2,25]},{hour:16,minutes:[2,25]},{hour:17,minutes:[2,25]},{hour:18,minutes:[2,25,49]},{hour:19,minutes:[1,25,50]},{hour:20,minutes:[19,49]},{hour:21,minutes:[29,49]},{hour:22,minutes:[7,25,39,53]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[12,27,42,55]},{hour:7,minutes:[17,37,57]},{hour:8,minutes:[17,37,57]},{hour:9,minutes:[19,55]},{hour:10,minutes:[19,31,55]},{hour:11,minutes:[19,31,55]},{hour:12,minutes:[19,31,55]},{hour:13,minutes:[19,31,55]},{hour:14,minutes:[19,31,55]},{hour:15,minutes:[19,31,55]},{hour:16,minutes:[19,31,55]},{hour:17,minutes:[19,31,55]},{hour:18,minutes:[19,31,55]},{hour:19,minutes:[31,55]},{hour:20,minutes:[37]},{hour:21,minutes:[12,52]},{hour:22,minutes:[12,32,53]},{hour:23,minutes:[]}]},route13:{name:"地下鉄長田駅 経由 兵庫駅方面",number:"13",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0017",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[54]},{hour:9,minutes:[]},{hour:10,minutes:[7,56]},{hour:11,minutes:[47]},{hour:12,minutes:[37]},{hour:13,minutes:[27]},{hour:14,minutes:[15]},{hour:15,minutes:[7,57]},{hour:16,minutes:[42]},{hour:17,minutes:[22]},{hour:18,minutes:[2,42]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[7,27,47]},{hour:8,minutes:[7,27,47]},{hour:9,minutes:[7,31,43]},{hour:10,minutes:[7,43]},{hour:11,minutes:[7,43]},{hour:12,minutes:[7,43]},{hour:13,minutes:[7,43]},{hour:14,minutes:[7,43]},{hour:15,minutes:[7,43]},{hour:16,minutes:[7,43]},{hour:17,minutes:[7,43]},{hour:18,minutes:[7,43]},{hour:19,minutes:[7,19,43]},{hour:20,minutes:[7,52]},{hour:21,minutes:[32]},{hour:22,minutes:[]},{hour:23,minutes:[]}]},route110:{name:"大学病院 経由 神戸駅方面",number:"110・112",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0122",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[55]},{hour:7,minutes:[17,31,45]},{hour:8,minutes:[5,16,26,38,57]},{hour:9,minutes:[1,13,37]},{hour:10,minutes:[13,37,49]},{hour:11,minutes:[13,37,49]},{hour:12,minutes:[13,37,49]},{hour:13,minutes:[13,37,49]},{hour:14,minutes:[13,37,49]},{hour:15,minutes:[13,37,49]},{hour:16,minutes:[13,37,49]},{hour:17,minutes:[13,37,49]},{hour:18,minutes:[13,38]},{hour:19,minutes:[13,37]},{hour:20,minutes:[5,34]},{hour:21,minutes:[9]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[7,27,47]},{hour:8,minutes:[7,27,47]},{hour:9,minutes:[7,31,43]},{hour:10,minutes:[7,43]},{hour:11,minutes:[7,43]},{hour:12,minutes:[7,43]},{hour:13,minutes:[7,43]},{hour:14,minutes:[7,43]},{hour:15,minutes:[7,43]},{hour:16,minutes:[7,43]},{hour:17,minutes:[7,43]},{hour:18,minutes:[7,43]},{hour:19,minutes:[7,19,43]},{hour:20,minutes:[7,52]},{hour:21,minutes:[32]},{hour:22,minutes:[]},{hour:23,minutes:[]}]}},yoshidacho:{route11A:{name:"板宿止まり",number:"11A",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0015",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[21,31,53]},{hour:7,minutes:[14,35,53]},{hour:8,minutes:[12,29,48]},{hour:9,minutes:[13]},{hour:10,minutes:[9,33]},{hour:11,minutes:[21]},{hour:12,minutes:[22]},{hour:13,minutes:[25]},{hour:14,minutes:[25]},{hour:15,minutes:[25]},{hour:16,minutes:[25]},{hour:17,minutes:[26,58]},{hour:18,minutes:[38]},{hour:19,minutes:[8,41]},{hour:20,minutes:[5,39]},{hour:21,minutes:[15,45]},{hour:22,minutes:[0,30,45]},{hour:23,minutes:[5]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[21]},{hour:7,minutes:[9,21,46]},{hour:8,minutes:[11,35]},{hour:9,minutes:[12]},{hour:10,minutes:[0,24]},{hour:11,minutes:[0,24]},{hour:12,minutes:[1,25]},{hour:13,minutes:[1,25]},{hour:14,minutes:[1,25]},{hour:15,minutes:[1,25]},{hour:16,minutes:[1,25,47]},{hour:17,minutes:[8,28,48]},{hour:18,minutes:[8]},{hour:19,minutes:[7,41,53]},{hour:20,minutes:[15,51]},{hour:21,minutes:[15,39,54]},{hour:22,minutes:[24,44]},{hour:23,minutes:[]}]},route11B:{name:"板宿 経由 松原町５丁目方面",number:"11B",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0015",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[]},{hour:9,minutes:[45]},{hour:10,minutes:[57]},{hour:11,minutes:[58]},{hour:12,minutes:[]},{hour:13,minutes:[1]},{hour:14,minutes:[1]},{hour:15,minutes:[1]},{hour:16,minutes:[1]},{hour:17,minutes:[1]},{hour:18,minutes:[8]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[]},{hour:9,minutes:[36]},{hour:10,minutes:[36]},{hour:11,minutes:[37]},{hour:12,minutes:[37]},{hour:13,minutes:[37]},{hour:14,minutes:[37]},{hour:15,minutes:[37]},{hour:16,minutes:[37]},{hour:17,minutes:[38]},{hour:18,minutes:[42]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}]},route13:{name:"板宿 経由 新長田駅前方面",number:"13",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0017",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[13]},{hour:9,minutes:[26]},{hour:10,minutes:[15]},{hour:11,minutes:[7,57]},{hour:12,minutes:[47]},{hour:13,minutes:[35]},{hour:14,minutes:[27]},{hour:15,minutes:[17]},{hour:16,minutes:[2,41]},{hour:17,minutes:[21]},{hour:18,minutes:[1]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[13]},{hour:9,minutes:[26]},{hour:10,minutes:[15]},{hour:11,minutes:[7,57]},{hour:12,minutes:[47]},{hour:13,minutes:[35]},{hour:14,minutes:[27]},{hour:15,minutes:[17]},{hour:16,minutes:[2,41]},{hour:17,minutes:[21]},{hour:18,minutes:[1]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}]},route110A:{name:"板宿止まり",number:"110A",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0122",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[41]},{hour:7,minutes:[3,26,46]},{hour:8,minutes:[7,25,43]},{hour:9,minutes:[8,36]},{hour:10,minutes:[24]},{hour:11,minutes:[12,36]},{hour:12,minutes:[12,39]},{hour:13,minutes:[15,39]},{hour:14,minutes:[16,39]},{hour:15,minutes:[15,39]},{hour:16,minutes:[15,39]},{hour:17,minutes:[15,40]},{hour:18,minutes:[20,50]},{hour:19,minutes:[20]},{hour:20,minutes:[16,52]},{hour:21,minutes:[31]},{hour:22,minutes:[16]},{hour:23,minutes:[26]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[36]},{hour:8,minutes:[0]},{hour:9,minutes:[3]},{hour:10,minutes:[15]},{hour:11,minutes:[15]},{hour:12,minutes:[15]},{hour:13,minutes:[15]},{hour:14,minutes:[15]},{hour:15,minutes:[15]},{hour:16,minutes:[15]},{hour:17,minutes:[19]},{hour:18,minutes:[20]},{hour:19,minutes:[20]},{hour:20,minutes:[40]},{hour:21,minutes:[28]},{hour:22,minutes:[11]},{hour:23,minutes:[6]}]},route110B:{name:"板宿 経由 鷹取駅方面",number:"110B",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0122",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[1,19,37]},{hour:9,minutes:[24]},{hour:10,minutes:[]},{hour:11,minutes:[]},{hour:12,minutes:[]},{hour:13,minutes:[]},{hour:14,minutes:[]},{hour:15,minutes:[]},{hour:16,minutes:[]},{hour:17,minutes:[]},{hour:18,minutes:[30]},{hour:19,minutes:[0,32,56]},{hour:20,minutes:[28]},{hour:21,minutes:[4]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[24]},{hour:9,minutes:[27]},{hour:10,minutes:[]},{hour:11,minutes:[]},{hour:12,minutes:[]},{hour:13,minutes:[]},{hour:14,minutes:[]},{hour:15,minutes:[]},{hour:16,minutes:[]},{hour:17,minutes:[32,56]},{hour:18,minutes:[32]},{hour:19,minutes:[4]},{hour:20,minutes:[4]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}]},route112:{name:"五位ノ池 経由 鷹取駅方面",number:"112",detailUrl:"https://location.its-mo.com/usersite/kobe/US0005/search/jp?busStopCode=0440&directionId=kobe0126",weekdays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[]},{hour:9,minutes:[]},{hour:10,minutes:[47]},{hour:11,minutes:[48]},{hour:12,minutes:[51]},{hour:13,minutes:[51]},{hour:14,minutes:[51]},{hour:15,minutes:[51]},{hour:16,minutes:[51]},{hour:17,minutes:[50]},{hour:18,minutes:[]},{hour:19,minutes:[]},{hour:20,minutes:[]},{hour:21,minutes:[]},{hour:22,minutes:[]},{hour:23,minutes:[]}],holidays:[{hour:5,minutes:[]},{hour:6,minutes:[]},{hour:7,minutes:[]},{hour:8,minutes:[48]},{hour:9,minutes:[51]},{hour:10,minutes:[51]},{hour:11,minutes:[51]},{hour:12,minutes:[51]},{hour:13,minutes:[51]},{hour:14,minutes:[51]},{hour:15,minutes:[51]},{hour:16,minutes:[59]},{hour:17,minutes:[]},{hour:18,minutes:[40]},{hour:19,minutes:[28]},{hour:20,minutes:[28]},{hour:21,minutes:[11]},{hour:22,minutes:[6]},{hour:23,minutes:[]}]}}};let currentDirection='yoshidacho';function getBusCurrentDateTime(){const t=document.getElementById("busTimeInput");if(t.value){const e=new Date(t.value);return isNaN(e.getTime())?new Date:e}return new Date}function updateScheduleType(){const t=getBusCurrentDateTime(),e=document.getElementById("scheduleType");let n=isHoliday(t)?"休日ダイヤ":"平日ダイヤ";document.getElementById("busTimeInput").value&&(n+=" (指定時刻)"),e.textContent=n,isHoliday(t)?(e.style.color="#cc0000",e.style.borderColor="#cc0000"):(e.style.color="#009900",e.style.borderColor="#009900")}function isHoliday(t){const e=t.getDay(),n=t.getMonth()+1,i=t.getDate(),o=t.getFullYear();return 2025===o&&8===n&&15===i||0===e||6===e}function getAllDepartures(){const t=getBusCurrentDateTime(),e=new Date(t.getTime()-3e5),n=[];const i=timetables[currentDirection],o=Object.keys(i),s=t=>{const e=isHoliday(t)?"holidays":"weekdays";o.forEach(a=>{const r=i[a];if(!r)return;r[e].forEach(e=>{e.minutes.forEach(i=>{const o=new Date(t);o.setHours(e.hour,i,0,0),n.push({routeName:r.name,routeNumber:r.number,date:o,detailUrl:r.detailUrl})})})})};{const e=new Date(t);e.setHours(0,0,0,0);const n=new Date(t);n.setDate(t.getDate()-1),n.setHours(0,0,0,0),s(n),s(e)}return n.filter(t=>t.date>=e).sort((t,e)=>t.date-e.date)}function updateJustDeparted(t){const e=document.getElementById("justDepartedSection"),n=getBusCurrentDateTime();const i=t.filter(t=>t.date<n&&(n.getTime()-t.date.getTime())<3e5);e.innerHTML="",i.length>0&&i.forEach(t=>{const n=`${String(t.date.getHours()).padStart(2,"0")}:${String(t.date.getMinutes()).padStart(2,"0")}`,i=document.createElement("div");i.className="just-departed-info",i.innerHTML=`<span><span class="route-number">${t.routeNumber}</span><strong>${t.routeName}</strong> (${n}発) の定刻は過ぎました。</span>`,e.appendChild(i)})}function createDepartureHTML(t,e){const n=t.date,i=`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`;let o="";"yoshidacho"===currentDirection&&(()=>{const t=new Date(n.getTime()+42e4),e=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`;o=`<div class="itayado-arrival">板宿 ${e} 着</div>`})();let s="";return t.detailUrl&&(s=`<a href="${t.detailUrl}" class="detail-button" target="_blank" rel="noopener noreferrer">※</a>`),`\n <div class="departure-item">\n <div class="next-departure-content">\n <div class="departure-details-left">\n <div class="departure-type-label">【${e}】</div>\n <div class="next-departure-route">\n <span class="route-number">${t.routeNumber}</span>${t.routeName}\n </div>\n ${o}\n </div>\n <div class="next-departure-time">\n <div class="next-departure-clock">${i}</div>\n <div class="time-and-button-row">\n <div class="next-departure-remaining"><span class="remaining-time-countdown" data-deptime="${n.getTime()}"></span></div>\n ${s}\n </div>\n </div>\n </div>\n </div>`}function updateUpcomingDepartures(t){const e=document.getElementById("upcomingDeparturesContainer"),n=t.filter(t=>t.date>=getBusCurrentDateTime()),i=n[0],o=n[1];if(!i)return void(e.innerHTML='<div class="no-next-departure">指定時刻以降の運行はありません</div>');let s=createDepartureHTML(i,"先発");s+=o?createDepartureHTML(o,"次発"):'<div class="departure-item"><div class="next-departure-content"><div class="departure-details-left"><div class="departure-type-label">【次発】</div></div><div class="no-next-departure" style="padding:0;">ありません</div></div></div>',e.innerHTML=s}function updateBusCountdowns(){const t=document.querySelectorAll(".remaining-time-countdown"),e=getBusCurrentDateTime().getTime();t.forEach(t=>{const n=parseInt(t.dataset.deptime,10);if(isNaN(n))return;const i=n-e,o=t.closest(".next-departure-remaining");if(i<0)return t.textContent="出発",void(o&&o.classList.remove("blink"));const s=Math.floor(i/6e4),a=Math.floor(i%6e4/1e3);t.textContent=s>99?`Left ${Math.floor(s/60)}h${String(s%60).padStart(2,"0")}m`:`Left ${String(s).padStart(2,"0")}:${String(a).padStart(2,"0")}`,o&&(i<6e4?o.classList.add("blink"):o.classList.remove("blink"))})}function updateDisplay(){const t=getAllDepartures();updateScheduleType(),updateJustDeparted(t),updateUpcomingDepartures(t),updateBusCountdowns()}function changeDirection(t){currentDirection=t,updateDisplay(),document.getElementById("shinkaichi-btn").classList.toggle("active","shinkaichi"===t),document.getElementById("yoshidacho-btn").classList.toggle("active","yoshidacho"===t)}
    
    // ★★ 変更: 時間計算ツールのロジック ★★
    function pad(n){return String(n).padStart(2,'0');}
    function calcTime() {
      const now = new Date();
      const addH = +document.getElementById('addHours').value || 0;
      const addM = +document.getElementById('addMinutes').value || 0;
      const addS = +document.getElementById('addSeconds').value || 0;
      const resultDate = new Date(now.getTime() + (addH * 3600 + addM * 60 + addS) * 1000);
      const h = pad(resultDate.getHours());
      const m = pad(resultDate.getMinutes());
      const s = pad(resultDate.getSeconds());

      const startOfToday = new Date(); startOfToday.setHours(0, 0, 0, 0);
      const startOfResultDay = new Date(resultDate); startOfResultDay.setHours(0, 0, 0, 0);
      const dayDiff = Math.round((startOfResultDay - startOfToday) / 86400000);
      let dayText = '';
      if (dayDiff > 0) { dayText = ` (+${dayDiff}d)`; }
      
      document.getElementById('resultTime').textContent = `${h}:${m}:${s}${dayText}`;
    }
    function resetCalc() {
      document.getElementById('addHours').value = 0;
      document.getElementById('addMinutes').value = 0;
      document.getElementById('addSeconds').value = 0;
      calcTime();
    }
    
    function init() {
      const savedTheme = localStorage.getItem('siteTheme') || 'light';
      setTheme(savedTheme);
      const savedTab = localStorage.getItem('siteActiveTab') || 'all';
      activateTab(savedTab);
      updateClockAndDate(); 
      updateDisplay(); 
      resetCalc(); // 初期表示のために呼び出し
      
      document.getElementById('shinkaichi-btn').addEventListener('click', () => changeDirection('shinkaichi'));
      document.getElementById('yoshidacho-btn').addEventListener('click', () => changeDirection('yoshidacho'));
      document.getElementById('busTimeInput').addEventListener('change', updateDisplay);
      document.getElementById('busTimeResetBtn').addEventListener('click', () => { document.getElementById('busTimeInput').value = ''; updateDisplay(); });
      document.getElementById('appSearchInput').addEventListener('input', filterContent);
      swipeArea.addEventListener('touchstart', handleTouchStart, false);
      swipeArea.addEventListener('touchend', handleTouchEnd, false);
      
      // ★★ 変更: 時間計算ツールのイベントリスナー ★★
      ['addHours', 'addMinutes', 'addSeconds'].forEach(id => {
        document.getElementById(id).addEventListener('input', calcTime);
      });
      document.getElementById('resetCalcBtn').addEventListener('click', resetCalc);
    }
    
    setInterval(() => { 
        updateClockAndDate(); 
        calcTime(); // 毎秒、計算結果も更新
        if (!document.getElementById('busTimeInput').value) {
            updateBusCountdowns();
        }
    }, 1000); 
    setInterval(() => {
        if (!document.getElementById('busTimeInput').value) {
            updateDisplay();
        }
    }, 30000); 
    
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
