<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Link First</title>
  <link rel="icon" href="./icon.png" type="image/png">
  <link rel="apple-touch-icon" href="./icon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
  <!-- å¤–éƒ¨CSSã®èª­ã¿è¾¼ã¿ -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã®ã‚µã‚¤ã‚ºã¨é…ç½®ã®èª¿æ•´ */
    .datetime-row {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-grow: 1;
    }
    .header-search-wrap {
        margin-left: 10px;
        flex-grow: 1;
        max-width: 600px; /* æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã®æœ€å¤§å¹… */
    }
    .search-container {
        width: 100% !important;
        height: 45px !important; /* é«˜ã•ã‚’å°‘ã—å¤§ãã */
        background: var(--input-bg, rgba(255,255,255,0.2));
        border-radius: 25px;
        display: flex;
        align-items: center;
        padding: 0 15px;
        border: 1px solid rgba(255,255,255,0.3);
    }
    #globalSearchInput {
        width: 100%;
        background: transparent;
        border: none;
        outline: none;
        color: inherit;
        font-size: 1.1rem; /* æ–‡å­—ã‚µã‚¤ã‚ºã‚’å°‘ã—å¤§ãã */
        margin-left: 10px;
    }
    /* ã‚‚ã¨ã‚‚ã¨ã®æ¤œç´¢ãƒãƒ¼ã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆç§»å‹•ã•ã›ãŸãŸã‚ï¼‰ */
    .search-wrapper {
        display: none;
    }
    
    @media (max-width: 768px) {
        .header-search-wrap {
            max-width: none;
        }
        .datetime-row {
            flex-wrap: wrap;
        }
    }
  </style>
</head>
<body>
  <div class="fixed-top-wrapper">
    <div class="clock-area">
        <div class="clock-main-row">
            <div class="left-section" style="display: flex; align-items: center; flex-grow: 1;">
                <img src="./icon.png" alt="Link First Logo" class="site-logo">
                <div class="datetime-row">
                    <div id="date"></div>
                    <div id="clock"></div>
                    <!-- ã€Œé™ç›®ï¼ˆcountdownï¼‰ã€ã‚’å‰Šé™¤ã—ã€ã“ã“ã«æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã‚’é…ç½® -->
                    <div class="header-search-wrap">
                        <div class="search-container"> 
                            <i class="fas fa-search"></i> 
                            <input type="text" id="globalSearchInput" placeholder="æ¤œç´¢ï¼ˆ!ã§DuckDuckGoï¼‰..." autocomplete="off"> 
                            <i class="fas fa-times hidden" id="clearSearchBtn"></i>
                        </div>
                        <div id="searchResults" class="search-results-dropdown hidden"></div>
                    </div>
                </div>
            </div>
             <div class="header-controls">
                <!-- Login Button -->
                <div id="auth-btn" title="Googleãƒ­ã‚°ã‚¤ãƒ³">
                    <i class="fab fa-google"></i>
                    <img id="user-avatar" src="" alt="User" />
                    <span id="user-name"></span>
                </div>
                <!-- Theme Switcher -->
                <div class="theme-switcher">
                    <div class="theme-dot light" onclick="setTheme('light')" title="Light Mode"></div>
                    <div class="theme-dot dark" onclick="setTheme('dark')" title="Dark Mode"></div>
                </div>
                <!-- Background Changer Button -->
                <div class="control-icon" onclick="openBgModal()" title="èƒŒæ™¯å¤‰æ›´"><i class="fas fa-image"></i></div>
                <!-- Network & Refresh -->
                <div id="network-status" class="online" title="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³"><i class="fas fa-wifi"></i> <span>ON</span></div>
                <div class="control-icon" id="refresh-button" onclick="location.reload()"><i class="fas fa-sync-alt"></i></div>
                <!-- SpeedTest PC -->
                <div class="header-speed-test" id="header-speed-test-container">
                    <iframe id="speed-test-iframe" src="https://fast.com/ja/" title="é€Ÿåº¦ãƒ†ã‚¹ãƒˆ" loading="lazy" scrolling="no"></iframe>
                    <div class="control-icon" id="speed-test-refresh-button" onclick="reloadSpeedTest()"><i class="fas fa-redo"></i></div>
                </div>
            </div>
        </div>
    </div>
  </div>

  <div class="page-container">
      <!-- FYã‚³ãƒ³ãƒ†ãƒŠ -->
      <div id="fy-container" style="display: block;">
          <div id="fy-clock-display">
              <div class="fy-clock-group">
                  <div id="fy-date-text" class="fy-date-text"></div>
                  <div id="fy-time-text" class="fy-time-text"></div>
              </div>
              <div id="fy-speed-test-placeholder"></div>
          </div>
          <div class="fy-header-row" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
              <h3 class="section-title" style="border:none; margin:0;"><i class="fas fa-star fy-icon"></i> ãŠæ°—ã«å…¥ã‚Š (Favorites)</h3>
              <button id="fy-edit-btn" class="edit-btn" onclick="toggleEditMode()" style="padding:5px 15px; border-radius:15px; cursor:pointer; background:var(--input-bg); border:1px solid #ccc;">ä¸¦ã³æ›¿ãˆ</button>
          </div>
          <div id="fy-content-area"></div>
      </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚°ã‚¢ãƒ—ãƒªä¸€è¦§ -->
    <div class="main-grid" id="main-grid" style="display: none;">
        <div id="all-apps-container">
            <h3 class="section-title">ã™ã¹ã¦ã®ã‚¢ãƒ—ãƒª</h3>
            <div class="grid-container" id="gridContainer"></div>
        </div>
    </div>

    <!-- Bustarain (äº¤é€š) ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div id="bustarain-container">
        <!-- ãƒ¢ãƒã‚¤ãƒ«ç‰ˆ -->
        <div id="traffic-mobile-view">
            <div class="sub-tab-menu">
                <button class="sub-tab-btn active" onclick="switchMobileSubTab('mobile-train')"><i class="fas fa-train"></i> Train</button>
                <button class="sub-tab-btn" onclick="switchMobileSubTab('mobile-bus')"><i class="fas fa-bus"></i> BUS</button>
            </div>
            <div id="mobile-train" class="traffic-grid sub-tab-content">
                <a href="Bustarain/train/wadmisaki-train.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-subway"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">å’Œç”°å²¬</div></div></a>
                <a href="Bustarain/train/itayado-train.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-subway"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">å¸°ï¼‰æ¿å®¿æ–°é•·ç”°çµŒç”±æµ·å²¸ç·š</div></div></a>
                <a href="Bustarain/train/Itayado-sannyou.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-train"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">æ¿å®¿é§…ï¼ˆå±±é™½é›»è»Šï¼‰</div></div></a>
            </div>
            <div id="mobile-bus" class="traffic-grid sub-tab-content hidden">
                <a href="Bustarain/bus/Buslocation.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-map-marked-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">ãƒã‚¹ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</div></div></a>
                <a href="Bustarain/bus/ikuei4split.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-bus"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">Locateè‚²è‹±é«˜æ ¡å‰</div></div></a>
                <a href="Bustarain/bus/iki-kaeri.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-exchange-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">è¡Œããƒ»å¸°ã‚Š</div></div></a>
                <a href="Bustarain/bus/imadezaike.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-bus-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">ä»Šå‡ºåœ¨å®¶</div></div></a>
                <a href="Bustarain/bus/yumeno3.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-bus-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">å¤¢é‡ç”º3ä¸ç›®</div></div></a>
                <a href="Bustarain/bus/takatoridantimae.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-bus-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">é«˜å–å›£åœ°å‰</div></div></a>
                <a href="Bustarain/bus/Itayado-bus.html" target="_blank" class="app-card traffic-card"><div class="card-left"><i class="fas fa-bus-alt"></i></div><div class="card-divider"></div><div class="card-right"><div class="card-title">æ¿å®¿é§…</div></div></a>
            </div>
        </div>

        <!-- PCç‰ˆ -->
        <div id="traffic-pc-view">
            <div class="pc-traffic-display">
                <div class="pc-display-header" id="pc-header-title">Select Info</div>
                <div class="pc-placeholder" id="pc-placeholder-msg">ãƒªã‚¹ãƒˆã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„</div>
                <iframe id="pc-main-iframe" src=""></iframe>
            </div>
            <div class="pc-traffic-sidebar">
                <div class="pc-sidebar-header">
                    <div class="scroll-arrow" onclick="scrollTrafficList(-50)"><i class="fas fa-chevron-up"></i></div>
                    <div class="pc-traffic-tabs">
                        <button class="pc-tab-btn" id="pc-btn-bus" onclick="switchPcTrafficTab('bus')">BUS</button>
                        <button class="pc-tab-btn active" id="pc-btn-train" onclick="switchPcTrafficTab('train')">Train</button>
                    </div>
                </div>
                <div id="pc-list-train" class="pc-traffic-list">
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/train/wadmisaki-train.html', this, 'ğŸšƒå’Œç”°å²¬')">å’Œç”°å²¬</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/train/wadmisaki-train.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/train/itayado-train.html', this, 'ğŸšƒå¸°ï¼‰æ¿å®¿æ–°é•·ç”°çµŒç”±æµ·å²¸ç·š')">å¸°ï¼‰æ¿å®¿æ–°é•·ç”°çµŒç”±æµ·å²¸ç·š</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/train/itayado-train.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/train/Itayado-sannyou.html', this, 'ğŸšƒæ¿å®¿é§…ï¼ˆå±±é™½é›»è»Šï¼‰')">æ¿å®¿é§…ï¼ˆå±±é™½é›»è»Šï¼‰</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/train/Itayado-sannyou.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                </div>
                <div id="pc-list-bus" class="pc-traffic-list hidden">
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/Buslocation.html', this, 'ãƒã‚¹ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³')">ğŸšŒãƒã‚¹ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/Buslocation.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/ikuei4split.html', this, 'Locateè‚²è‹±é«˜æ ¡å‰')">ğŸšŒLocateè‚²è‹±é«˜æ ¡å‰</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/ikuei4split.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/iki-kaeri.html', this, 'è¡Œããƒ»å¸°ã‚Š')">ğŸšŒè¡Œããƒ»å¸°ã‚Š</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/iki-kaeri.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/imadezaike.html', this, 'ä»Šå‡ºåœ¨å®¶')">ğŸšŒå’Œç”°å²¬(bus)ã€œä¸­å¤®å¸‚å ´å‰(bus)</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/imadezaike.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/yumeno3.html', this, 'å¤¢é‡ç”º3ä¸ç›®')">ğŸšŒå¤¢é‡ç”º3ä¸ç›®</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/yumeno3.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/takatoridantimae.html', this, 'é«˜å–å›£åœ°å‰')">ğŸšŒé«˜å–å›£åœ°å‰</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/takatoridantimae.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    <div class="pc-traffic-item">
                        <span class="pc-item-label" onclick="loadPcTraffic('Bustarain/bus/Itayado-bus.html', this, 'æ¿å®¿é§…')">ğŸšŒæ¿å®¿é§…å‰</span>
                        <button class="pc-new-tab-btn" onclick="openNewTab('Bustarain/bus/Itayado-bus.html', event)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                </div>
                <div class="pc-sidebar-footer">
                    <div class="scroll-arrow" onclick="scrollTrafficList(50)"><i class="fas fa-chevron-down"></i></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¡ãƒ¢å¸³ ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div id="memo-container">
        <h3 class="section-title"><i class="fas fa-sticky-note"></i> ãƒ¡ãƒ¢å¸³ (Auto Save)</h3>
        <textarea id="memo-pad" placeholder="ã“ã“ã«ãƒ¡ãƒ¢ã‚’å…¥åŠ›..."></textarea>
        <div id="memo-status"></div>
    </div>
  </div>

  <nav class="bottom-nav">
      <div class="tab-item active" id="tab-fy" onclick="activateTab('fy')"> <i class="fas fa-star fy-icon"></i> <span>FYâ˜†</span> </div>
      <div class="tab-item" id="tab-all-apps" onclick="activateTab('all-apps')"> <i class="fas fa-th-large"></i> <span>Apps</span> </div>
      <div class="tab-item" id="tab-bustarain" onclick="activateTab('bustarain')"> <i class="fas fa-bus"></i> <span>Traffic</span> </div>
      <div class="tab-item" id="tab-memo" onclick="activateTab('memo')"> <i class="fas fa-pen-alt"></i> <span>Memo</span> </div>
  </nav>

  <!-- èƒŒæ™¯é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="bg-select-overlay" class="modal-overlay hidden">
      <div class="modal-box">
          <div class="modal-title">èƒŒæ™¯ã‚’è¨­å®š</div>
          <input type="file" id="bg-file-input" accept="image/*" style="display:block; margin:0 auto 20px auto;">
          <div class="modal-buttons">
              <button class="modal-btn btn-cancel" onclick="closeBgModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
              <button class="modal-btn" style="background:#f44336; color:#fff;" onclick="resetBackground()">ãƒªã‚»ãƒƒãƒˆ</button>
          </div>
      </div>
  </div>
  
  <script type="module" src="script.js"></script>
  
  <script>
      /**
       * æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã®ç‰¹æ®Šã‚³ãƒãƒ³ãƒ‰å‡¦ç†
       */
      document.addEventListener('DOMContentLoaded', () => {
          const searchInput = document.getElementById('globalSearchInput');
          if (searchInput) {
              searchInput.addEventListener('keydown', (e) => {
                  if (e.key === 'Enter') {
                      const val = searchInput.value.trim();
                      if (val.startsWith('!') || val.startsWith('ï¼')) {
                          e.preventDefault();
                          let query = val.substring(1);
                          query = kanaToRoman(query);
                          if (query.length > 0) {
                              const url = `https://duckduckgo.com/?q=!${encodeURIComponent(query)}&t=ipad&ia=web`;
                              window.open(url, '_blank');
                              searchInput.value = '';
                          }
                      }
                  }
              });
          }

          function kanaToRoman(str) {
              let res = str.replace(/[ï¼-ï½]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0));
              const romanMap = {
                  'ã‚': 'a', 'ã„': 'i', 'ã†': 'u', 'ãˆ': 'e', 'ãŠ': 'o',
                  'ã‹': 'ka', 'ã': 'ki', 'ã': 'ku', 'ã‘': 'ke', 'ã“': 'ko',
                  'ã•': 'sa', 'ã—': 'shi', 'ã™': 'su', 'ã›': 'se', 'ã': 'so',
                  'ãŸ': 'ta', 'ã¡': 'chi', 'ã¤': 'tsu', 'ã¦': 'te', 'ã¨': 'to',
                  'ãª': 'na', 'ã«': 'ni', 'ã¬': 'nu', 'ã­': 'ne', 'ã®': 'no',
                  'ã¯': 'ha', 'ã²': 'hi', 'ãµ': 'fu', 'ã¸': 'he', 'ã»': 'ho',
                  'ã¾': 'ma', 'ã¿': 'mi', 'ã‚€': 'mu', 'ã‚': 'me', 'ã‚‚': 'mo',
                  'ã‚„': 'ya', 'ã‚†': 'yu', 'ã‚ˆ': 'yo',
                  'ã‚‰': 'ra', 'ã‚Š': 'ri', 'ã‚‹': 'ru', 'ã‚Œ': 're', 'ã‚': 'ro',
                  'ã‚': 'wa', 'ã‚’': 'wo', 'ã‚“': 'n',
                  'ãŒ': 'ga', 'ã': 'gi', 'ã': 'gu', 'ã’': 'ge', 'ã”': 'go',
                  'ã–': 'za', 'ã˜': 'ji', 'ãš': 'zu', 'ãœ': 'ze', 'ã': 'zo',
                  'ã ': 'da', 'ã¢': 'ji', 'ã¥': 'zu', 'ã§': 'de', 'ã©': 'do',
                  'ã°': 'ba', 'ã³': 'bi', 'ã¶': 'bu', 'ã¹': 'be', 'ã¼': 'bo',
                  'ã±': 'pa', 'ã´': 'pi', 'ã·': 'pu', 'ãº': 'pe', 'ã½': 'po'
              };
              let kana = res.replace(/[\u30a1-\u30f6]/g, s => String.fromCharCode(s.charCodeAt(0) - 0x60));
              let result = "";
              for (let i = 0; i < kana.length; i++) {
                  result += romanMap[kana[i]] || kana[i];
              }
              return result;
          }
      });

      // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯
      window.activateTab = function(tabName) {
          const containers = ['fy-container', 'main-grid', 'bustarain-container', 'memo-container'];
          containers.forEach(id => {
              const el = document.getElementById(id);
              if (el) el.style.display = 'none';
          });
          const tabs = ['tab-fy', 'tab-all-apps', 'tab-bustarain', 'tab-memo'];
          tabs.forEach(id => {
              const el = document.getElementById(id);
              if (el) el.classList.remove('active');
          });
          if (tabName === 'fy') {
              document.getElementById('fy-container').style.display = 'block';
              document.getElementById('tab-fy').classList.add('active');
          } else if (tabName === 'all-apps') {
              document.getElementById('main-grid').style.display = 'block';
              document.getElementById('tab-all-apps').classList.add('active');
          } else if (tabName === 'bustarain') {
              document.getElementById('bustarain-container').style.display = 'block';
              document.getElementById('tab-bustarain').classList.add('active');
          } else if (tabName === 'memo') {
              document.getElementById('memo-container').style.display = 'block';
              document.getElementById('tab-memo').classList.add('active');
          }
          window.scrollTo(0, 0);
      };

      // ãƒ¢ãƒã‚¤ãƒ«ã‚µãƒ–ã‚¿ãƒ–
      window.switchMobileSubTab = function(contentId) {
          document.getElementById('mobile-train').classList.add('hidden');
          document.getElementById('mobile-bus').classList.add('hidden');
          document.querySelectorAll('.sub-tab-btn').forEach(btn => btn.classList.remove('active'));
          document.getElementById(contentId).classList.remove('hidden');
          if(contentId === 'mobile-train') {
              document.querySelector('.sub-tab-btn:nth-child(1)').classList.add('active');
          } else {
              document.querySelector('.sub-tab-btn:nth-child(2)').classList.add('active');
          }
      };

      // PC Traffic
      window.switchPcTrafficTab = function(type) {
          const trainList = document.getElementById('pc-list-train');
          const busList = document.getElementById('pc-list-bus');
          const btnTrain = document.getElementById('pc-btn-train');
          const btnBus = document.getElementById('pc-btn-bus');
          if (type === 'train') {
              trainList.classList.remove('hidden'); busList.classList.add('hidden');
              btnTrain.classList.add('active'); btnBus.classList.remove('active');
          } else {
              trainList.classList.add('hidden'); busList.classList.remove('hidden');
              btnTrain.classList.remove('active'); btnBus.classList.add('active');
          }
      };

      window.loadPcTraffic = function(url, labelElement, title) {
          const iframe = document.getElementById('pc-main-iframe');
          const placeholder = document.getElementById('pc-placeholder-msg');
          const headerTitle = document.getElementById('pc-header-title');
          placeholder.style.display = 'none';
          iframe.src = url;
          if(title) headerTitle.textContent = title;
          document.querySelectorAll('.pc-traffic-item').forEach(el => el.classList.remove('active'));
          if(labelElement && labelElement.parentElement) labelElement.parentElement.classList.add('active');
      };

      window.openNewTab = function(url, event) {
          event.stopPropagation(); window.open(url, '_blank');
      }

      window.scrollTrafficList = function(amount) {
          const activeList = document.querySelector('.pc-traffic-list:not(.hidden)');
          if(activeList) activeList.scrollBy({ top: amount, behavior: 'smooth' });
      };

      // ãƒ¡ãƒ¢å¸³
      document.addEventListener('DOMContentLoaded', () => {
          const memoPad = document.getElementById('memo-pad');
          const memoStatus = document.getElementById('memo-status');
          if (memoPad) {
              const savedMemo = localStorage.getItem('userMemo');
              if (savedMemo) memoPad.value = savedMemo;
              let timeoutId;
              memoPad.addEventListener('input', () => {
                  memoStatus.textContent = 'ä¿å­˜ä¸­...';
                  clearTimeout(timeoutId);
                  timeoutId = setTimeout(() => {
                      localStorage.setItem('userMemo', memoPad.value);
                      memoStatus.textContent = 'ä¿å­˜ã—ã¾ã—ãŸ';
                      setTimeout(() => { memoStatus.textContent = ''; }, 2000);
                  }, 1000); 
              });
          }
      });
  </script>
</body>
</html>
